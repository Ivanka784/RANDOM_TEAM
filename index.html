<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Generator (Debug Version)</title>
    <style>
        :root {
            --primary-color: #2ecc71;
            --bg-color: #f4f7f6;
            --text-color: #333;
        }

        body {
            font-family: sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        /* –Ü–ù–î–ò–ö–ê–¢–û–† –†–ï–ñ–ò–ú–£ */
        .mode-panel {
            background: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .dot {
            width: 15px; height: 15px; border-radius: 50%; display: inline-block;
            border: 2px solid rgba(0,0,0,0.1);
        }
        .dot-green { background: #2ecc71; box-shadow: 0 0 10px #2ecc71; }
        .dot-yellow { background: #f1c40f; box-shadow: 0 0 10px #f1c40f; }
        .dot-red { background: #e74c3c; box-shadow: 0 0 10px #e74c3c; animation: pulse 1s infinite alternate; }

        @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.2); } }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 600px;
            text-align: center;
        }

        textarea {
            width: 100%; height: 150px; padding: 10px; margin-bottom: 15px;
            border: 2px solid #ddd; border-radius: 8px; font-size: 16px;
        }

        .controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 15px; }
        input[type="number"] { width: 60px; padding: 8px; border-radius: 5px; border: 1px solid #ccc; }

        button {
            background-color: var(--primary-color); color: white; border: none;
            padding: 12px 24px; font-size: 16px; border-radius: 8px; cursor: pointer; width: 100%;
            font-weight: bold;
        }
        button:hover { opacity: 0.9; }

        /* –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê */
        .debug-box {
            margin-top: 15px;
            padding: 10px;
            background: #f8f9fa;
            border: 1px dashed #ccc;
            border-radius: 5px;
            font-size: 0.85em;
            color: #555;
            text-align: left;
        }

        .result-area { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-top: 20px; width: 100%; }
        .card { background: white; border-top: 4px solid var(--primary-color); padding: 15px; width: 45%; box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-align: left; }
        .card.reserve { border-top-color: #95a5a6; background: #fafafa; }
        .card ul { padding-left: 20px; margin: 5px 0; }
        .vip-tag { color: #e67e22; font-weight: bold; }
    </style>
</head>
<body>

    <div class="mode-panel">
        –†–ï–ñ–ò–ú: 
        <span id="modeDot" class="dot dot-yellow"></span>
        <span id="modeText">–°—Ç–∞–Ω–¥–∞—Ä—Ç (60%)</span>
    </div>

    <div class="container">
        <textarea id="namesInput" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º–µ–Ω–∞ (Ivanka784, I_Oleg_I —Ç–∞ —ñ–Ω—à—ñ)..."></textarea>

        <div class="controls">
            –ö–æ–º–∞–Ω–¥: <input type="number" id="teamsCount" value="2" min="1">
            –ú—ñ—Å—Ü—å: <input type="number" id="teamSize" value="5" min="1">
        </div>

        <button onclick="generate()">–°–§–û–†–ú–£–í–ê–¢–ò</button>

        <div id="debugBox" class="debug-box">
            –û—á—ñ–∫—É–≤–∞–Ω–Ω—è...<br>
            –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏", —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –¥–µ—Ç–∞–ª—ñ.
        </div>
    </div>

    <div id="resultArea" class="result-area"></div>

    <script>
        // === –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –Ü–ú–ï–ù (–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–∂–Ω—É –ª—ñ—Ç–µ—Ä—É!) ===
        // –°–∫—Ä–∏–ø—Ç —à—É–∫–∞—î, —á–∏ –º—ñ—Å—Ç–∏—Ç—å—Å—è —Ü–µ–π —Ç–µ–∫—Å—Ç —É —Ä—è–¥–∫—É. –†–µ–≥—ñ—Å—Ç—Ä (–≤–µ–ª–∏–∫—ñ/–º–∞–ª—ñ) –Ω–µ –≤–∞–∂–ª–∏–≤–∏–π.
        const VIP_NAMES = ["Ivanka784", "I_Oleg_I"];

        // === –ó–ú–Ü–ù–ù–Ü ===
        let currentMode = 'yellow'; // 'green', 'yellow', 'red'
        
        // === –ö–ï–†–£–í–ê–ù–ù–Ø (–°—Ç—Ä—ñ–ª–æ—á–∫–∏) ===
        let keys = [];
        document.addEventListener('keydown', (e) => {
            if (['ArrowLeft', 'ArrowRight', 'ArrowDown'].includes(e.key)) {
                keys.push(e.key);
                if (keys.length > 3) keys.shift(); // –¢—Ä–∏–º–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 3

                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π
                if (keys.join(',') === 'ArrowRight,ArrowRight,ArrowRight') setMode('red');
                if (keys.join(',') === 'ArrowLeft,ArrowLeft,ArrowLeft') setMode('green');
                if (keys.join(',') === 'ArrowDown,ArrowDown,ArrowDown') setMode('yellow');
            } else {
                keys = [];
            }
        });

        function setMode(mode) {
            currentMode = mode;
            const dot = document.getElementById('modeDot');
            const text = document.getElementById('modeText');
            
            dot.className = 'dot'; // —Å–∫–∏–¥–∞–Ω–Ω—è
            
            if (mode === 'red') {
                dot.classList.add('dot-red');
                text.innerText = "–ë–û–ì (100% –†–∞–∑–æ–º)";
            } else if (mode === 'green') {
                dot.classList.add('dot-green');
                text.innerText = "–ß–µ—Å–Ω–∏–π (0% –†–∞–∑–æ–º)";
            } else {
                dot.classList.add('dot-yellow');
                text.innerText = "–°—Ç–∞–Ω–¥–∞—Ä—Ç (60% –†–∞–∑–æ–º)";
            }
        }

        // === –ì–ï–ù–ï–†–ê–¶–Ü–Ø ===
        function generate() {
            const input = document.getElementById('namesInput').value;
            const teamsCount = parseInt(document.getElementById('teamsCount').value);
            const teamSize = parseInt(document.getElementById('teamSize').value);
            const debugBox = document.getElementById('debugBox');
            const resultArea = document.getElementById('resultArea');

            resultArea.innerHTML = '';
            
            // 1. –û—á–∏—Å—Ç–∫–∞ —ñ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —ñ–º–µ–Ω
            let allNames = input.split('\n').map(n => n.trim()).filter(n => n);
            
            if (allNames.length === 0) {
                debugBox.innerHTML = "‚ùå –ü–æ–º–∏–ª–∫–∞: –°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π.";
                return;
            }

            // 2. –ü–æ—à—É–∫ VIP-—ñ–≤ —É —Å–ø–∏—Å–∫—É
            let detectedVips = [];
            let normalPeople = [];

            allNames.forEach(name => {
                // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ VIP (–±–µ–∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —Ä–µ–≥—ñ—Å—Ç—Ä—É)
                let isVip = VIP_NAMES.some(v => name.toLowerCase().includes(v.toLowerCase()));
                if (isVip) {
                    detectedVips.push(name);
                } else {
                    normalPeople.push(name);
                }
            });

            // 3. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–ª—ñ (–ß–∏ —Å–ø—Ä–∞—Ü—é–≤–∞–≤ —à–∞–Ω—Å)
            let glueThem = false;
            if (currentMode === 'red') glueThem = true;
            if (currentMode === 'green') glueThem = false;
            if (currentMode === 'yellow') glueThem = Math.random() < 0.6;

            // –ó–í–Ü–¢ –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ò
            let log = `<b>–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</b><br>`;
            log += `–†–µ–∂–∏–º: ${currentMode.toUpperCase()}<br>`;
            log += `–ó–Ω–∞–π–¥–µ–Ω–æ VIP —É —Å–ø–∏—Å–∫—É: <b>${detectedVips.length}</b> (–ü–æ—Ç—Ä—ñ–±–Ω–æ 2)<br>`;
            if (detectedVips.length < 2) {
                 log += `<span style="color:red">‚ö†Ô∏è –£–≤–∞–≥–∞: –©–æ–± —Å–ø—Ä–∞—Ü—é–≤–∞–≤ "–∫–ª–µ–π", –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ –æ–±–∏–¥–≤–∞ —ñ–º–µ–Ω—ñ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è.</span><br>`;
                 glueThem = false; // –ù–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–ª–µ—ó—Ç–∏ –æ–¥–Ω–æ–≥–æ
            } else {
                 log += `–Ü–º–µ–Ω–∞ VIP: ${detectedVips.join(', ')}<br>`;
                 log += `–°–ø—Ä–∞—Ü—é–≤–∞–≤ "–ö–ª–µ–π": <b>${glueThem ? "–¢–ê–ö ‚úÖ" : "–ù–Ü ‚ùå"}</b><br>`;
            }
            debugBox.innerHTML = log;

            // 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–º–∞–Ω–¥
            let teams = Array.from({length: teamsCount}, () => []);

            // 5. –õ–û–ì–Ü–ö–ê –†–û–ó–ü–û–î–Ü–õ–£
            if (glueThem) {
                // –ö—Ä–æ–∫ –ê: –ö–∏–¥–∞—î–º–æ VIP-—ñ–≤ —Ä–∞–∑–æ–º –≤ –≤–∏–ø–∞–¥–∫–æ–≤—É –∫–æ–º–∞–Ω–¥—É
                let randomTeam = Math.floor(Math.random() * teamsCount);
                teams[randomTeam].push(...detectedVips);
            } else {
                // –Ø–∫—â–æ –∫–ª–µ–π –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–≤, VIP —Å—Ç–∞—é—Ç—å –∑–≤–∏—á–∞–π–Ω–∏–º–∏ –ª—é–¥—å–º–∏
                normalPeople.push(...detectedVips);
                // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ —ó—Ö, —â–æ–± –≤–æ–Ω–∏ –Ω–µ –π—à–ª–∏ –ø—ñ–¥—Ä—è–¥
                shuffle(normalPeople); 
            }

            // –ö—Ä–æ–∫ –ë: –†–æ–∑–ø–æ–¥—ñ–ª—è—î–º–æ —ñ–Ω—à–∏—Ö
            shuffle(normalPeople);
            
            let currentTeam = 0;
            while (normalPeople.length > 0) {
                // –®—É–∫–∞—î–º–æ –∫–æ–º–∞–Ω–¥—É –∑ –≤—ñ–ª—å–Ω–∏–º –º—ñ—Å—Ü–µ–º
                let added = false;
                for (let i = 0; i < teamsCount; i++) {
                    let idx = (currentTeam + i) % teamsCount;
                    if (teams[idx].length < teamSize) {
                        teams[idx].push(normalPeople.shift());
                        currentTeam = idx + 1;
                        added = true;
                        break;
                    }
                }
                // –Ø–∫—â–æ –≤—Å—ñ –∫–æ–º–∞–Ω–¥–∏ –ø–æ–≤–Ω—ñ, –∑—É–ø–∏–Ω—è—î–º–æ—Å—å (—Ä–µ—à—Ç–∞ –≤ –∑–∞–ø–∞—Å)
                if (!added) break;
            }

            // –ó–∞–ø–∞—Å
            let reserve = normalPeople;

            // 6. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
            teams.forEach((team, i) => {
                // –ü–µ—Ä–µ–º—ñ—à—É—î–º–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –∫—Ä–∞—Å–∏
                shuffle(team);
                drawCard(`–ö–æ–º–∞–Ω–¥–∞ ${i+1}`, team, teamSize);
            });

            if (reserve.length > 0) {
                drawCard("–†–µ–∑–µ—Ä–≤", reserve, null, true);
            }
        }

        function drawCard(title, members, max, isReserve = false) {
            let html = `<div class="card ${isReserve ? 'reserve' : ''}"><h3>${title} <small>${max ? members.length+'/'+max : members.length}</small></h3><ul>`;
            members.forEach(m => {
                // –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞ VIP –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç—ñ (–º–æ–∂–Ω–∞ –ø—Ä–∏–±—Ä–∞—Ç–∏)
                let isVip = VIP_NAMES.some(v => m.toLowerCase().includes(v.toLowerCase()));
                if (isVip) html += `<li class="vip-tag">‚òÖ ${m}</li>`;
                else html += `<li>üë§ ${m}</li>`;
            });
            html += `</ul></div>`;
            document.getElementById('resultArea').innerHTML += html;
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
    </script>
</body>
</html>
